---
{"dg-publish":true,"permalink":"/06-full-notes/3/","dgPassFrontmatter":true}
---

# Tags
[[03 - Tags/가상 면접 사례로 배우는 대규모 시스템 설계 기초 1권\|가상 면접 사례로 배우는 대규모 시스템 설계 기초 1권]]

---
# 핵심 요약
- 질문을 통해 확인하라.
- 문제의 요구 사항을 이해하라.
- 면접관과 소통해라.
- 개략적인 설계부터 시작하자.
- 개략적인 설계가 끝나면 면접관에게 확인을 하고 세부 사항을 설계한다.
- 진행 중에 막혔으면, 힌트를 청하기를 주저하지 마라.
---
# 핵심 필기
## 시스템 설계 면접의 핵심
### 면접에서 완벽한 설계를 기대하지 않는다.
때로 인터뷰어에게  '구글의 검색 서비스를 설계하라'는 질문이 들어올 수도 있다. 질문을 받은 사람은 그러한 글로벌 서비스를 짧은 시간 내에 설계하는 게 말이 안된다고 생각할 것이다. 사실, 면접관도 동일하게 생각한다.
시스템 설계 면접은 기술적인 내용과 협업 능력을 보는 과정이다. 면접자는 모호한 질문을 재차 확인하여 해결해야 할 일을 명확시한다. 문제를 명확시 했다면  그에 대한 해결 방안. 즉, 자신의 설계 능력을 보이고, 들어오는 의견에 대해서 방어를 하거나 혹은 타당한 의견이라면 이를 수용하여 설계를 변경할 수 있어야 한다. 
또한, 부정적인 면도 피할 줄 알아야 한다. 설계의 순수성(purity)에 집착하여 타협적 결정(trade-off)를 전부 피하고 과도한 엔지니어링(오버엔지니어링)을 적용하는 것도 좋지 않다. 이러한 설계는 비용적인 면에서 회사에 막대한 손해를 입힌다. 

---
## 효과적 면접을 위한 4단계 접근법
### 1단계: 문제 이해 및 설계 범위 설정
- 성급하게 답변하지 않을 것.
	- 깊이 생각하지 않고 시급하게 답변을 하면 첫 설계부터 망가질 수 있다.
- 질문에 대한 질문을 할 것.
	- 질문을 명확히 이해하지 못했거나, 설계에 추가적인 정보가 필요하다면 해당 질문을 할 것.
	- 면접자에게 질문을 한다면 면접자는 상세하게 대답을 해주거나 혹은 상황을 직접 가정하라고 얘기할 것이다. 후자에 경우엔, 자신이 생각한 가정 사항을 메모해놓고 이를 설계에 적용한다.
- 요구 사항을 정확히 이해하는데 필요한 질문은 다음과 같은 것들이 있다.
	- 구체적으로 어떤 기능들이 필요한가?
	- 제품 사용자 수는 얼마나 되나?
	- 회사의 규모는 얼마나 빨리 커지리라 예상하나? 석 달, 여섯 달, 일년 뒤의 규모는 얼마로 예상하는가?
	- 회사가 주로 사용하는 기술 스택은 무엇인가? 설계를 단순화하기 위해 활용할 수 있는 기존 기술이 있는가?
#### 예제: 뉴스 피드 시스템 설계
- 뉴스 피드(news feed) 시스템을 설계하라.
- 요구 사항을 분명히 하기 위해 면접자에게 질문
-  면접자와 문답은 다음과 같다.
	 - 지원자: 모바일 앱과 웹 앱 가운데 어느 쪽을 지원해야 하나요? 아니면 둘 다 지원해야하나요?
	 - 면접자: 둘 다 지원한다.
	 - 지원자: 가장 중요한 기능은 무엇인가요?
	 - 면접관: 새로운 포스트를 올리고, 다른 친구의 뉴스 피드를 볼 수 있는 것
	 - 지원자: 이 뉴스 피드는 시간 역순으로 정렬되어야 하나요? 아니면 다른 특별한 기준이 있나요? 제가 특별한 기준이 있는 지 묻는 이유는, 피드에 올라갈 포스트마다 다른 가중치가 부여되어야 하는지 알고 싶어서 인데요. 가령 가까운 친구의 포스트가 사용자 그룹(user group)에 올라가는 포스트보다 더 중요하다거나
	 - 면접자: 문제를 단순화하기 위해서 시간 역순으로 정렬된다고 가정해봅시다.
	 - 지원자: 한 사용자는 최대 몇 명의 사용자와 친구를 맺을 수 있나요?
	 - 면접관: 5000명입니다.
	 - 지원자: 사이트로 오는 트래픽 규모는 어느 정도입니까?
	 - 면접관: 일간 능동 사용자(daily active user, DAU)는 천만 명입니다.
	 - 지원자: 피드에 이미지나 비디오도 올라올 수 있나요? 아니면 텍스트입니까?
	 - 면접관: 이미지나 비디오 같은 미디어 파일도 포스트 할 수 있어야 합니다.
### 2단계: 개략적인 설계안 제시 및 동의 구하기
- 세부 사항의 설계에 들어가기 전에 대략적인 청사진을 먼저 구성한다.
- 면접관에게 현재 청사진을 제시하고 의견을 구하라.
- 화이트보드나 종이에 핵심 컴포넌트를 포함하는 다이어그램을 그려라. 클라이언트(모바일/웹), API, 웹 서버, 데이터 저장소, 캐시, CDN, 메시지 큐 등이 포함될 수 있다.
- 현재 설계안이 **시스템 규모**에 관계된 제약사항들을 만족하는지를 계산해봐라. 개략적 추정이 필요한지는 면접관에게 질문하라.
### 3단계: 상세 설계
#### 예제
"뉴스 피드 시스템을 설계하라"는 질문을 그대로 활용하여 설계를 해보자.
필요한 기능으로는 뉴스 피드 발행, 뉴스 피드 생성이 있다.
- 피드 저장: 사용자가 피드를 올리면 데이터베이스와 캐시에 저장되고 사용자의 친구 피드에 해당 피드가 뜬다.
- 피드 전송: 특정 사용자의 피드 목록을 만든다. 피드 목록엔 사용자의 친구들에 피드가 시간 역순으로 정렬된다.
	- 피드 전송은 메인 서비스이며 수많은 사용자로부터 잦은 요청이 들어오므로 지연성이 낮을 필요가 있다. (NoSQL: key-value 혹은 문서형)
	- 피드 목록은 영구적으로 저장할 필요가 없다. => 인메모리 기반
	- 동적 컨텐츠를 저장하므로 Redis가 좋겠다. => Elasticcache for Redis
![Pasted image 20250118142134.png](/img/user/Pasted%20image%2020250118142134.png)
#### 예제
> [!NOTE]
> 책에 큐 서버랑 세부 설계가 나오는데 이해가 이 부분은 내용 정리를 안했음. 해당 구조를 취하는 상세 설명이 없이 단순하게 완성된 구조를 그림으로 보여줌. 그래서 스킵함. 차라리 다음 챕터에서 상세 설명 보는 게 나아보인다.
### 4단계 마무리
최종 설계를 통해서 추가적인 질문을 던질 수도 있다. 따라서, 다음과 같은 질문에 대비해라.
- 병목구간, 혹은 개선 가능한 지점을 찾으라 주문할 수 있다. => 비판적 사고를 검증하는 파트
- 오류 발생하면 무슨 일이 생기는지(서버 오류, 네트워크 장애) 시나리오를 생각
- 운영 부분도 생각하면 좋다. 매트릭 수집 방법, 모니터링, 로그 수집, 시스템 배포 방법
- 미래에 규모 확장에 대해서도 생각
	- Elasticcache for Redis의 경우, 읽기 복제본 스케일링이 가능하다.
	- RDS의 경우엔, Aurora 엔진을 사용하여 스토리지나 읽기 복제본 생성 등 동적 확장이 가능하다.
---
# 참고 자료
caching strategies for Memcached
https://docs.aws.amazon.com/AmazonElastiCache/latest/dg/Strategies.html#Strategies.WriteThrough
Aurora
https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/AuroraUserGuide/Aurora.Managing.Performance.html
Redis
https://docs.aws.amazon.com/ko_kr/AmazonElastiCache/latest/dg/AutoScaling-Policies.html