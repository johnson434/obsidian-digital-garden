---
{"dg-publish":true,"permalink":"/06-full-notes/terraform-data-block/","noteIcon":""}
---

# **Tags**
- [[03 - Tags/Terraform\|Terraform]]

---

# **ë‹¨ì„œ ì§ˆë¬¸ ë° ë‹µë³€**

### **Q1: Terraform `data` ë¦¬ì†ŒìŠ¤ë€?**

âœ… **Terraformì´ ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒ(`read-only`)í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•˜ëŠ” ê¸°ëŠ¥**.  
âœ… **ê´€ë¦¬í˜• ë¦¬ì†ŒìŠ¤(`resource`)ì™€ ë‹¬ë¦¬ ìƒˆë¡œìš´ ì¸í”„ë¼ë¥¼ ìƒì„±í•˜ì§€ ì•Šê³ , ê¸°ì¡´ ì¸í”„ë¼ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ìš©ë„ë¡œ ì‚¬ìš©**.

---

### **Q2: Terraform `data` ë¦¬ì†ŒìŠ¤ëŠ” ì–¸ì œ `plan`ì—ì„œ ì¡°íšŒí•˜ê³ , ì–¸ì œ `apply`ê¹Œì§€ ë¯¸ë£¨ëŠ”ê°€?**

âœ… ê¸°ë³¸ì ìœ¼ë¡œ **`plan` ë‹¨ê³„ì—ì„œ ë°ì´í„° ì¡°íšŒ**.  
âœ… í•˜ì§€ë§Œ ì•„ë˜ ê²½ìš°ì—ëŠ” **`apply` ë‹¨ê³„ê¹Œì§€ ì¡°íšŒë¥¼ ë¯¸ë£¸**:

1. `apply` ì§ì „ê¹Œì§€ ì˜ˆì¸¡í•  ìˆ˜ ì—†ëŠ” ê°’ì¸ ê²½ìš°.
2. **í˜„ì¬ `plan`ì— ì˜í•´ ë³€ê²½ë˜ëŠ” ë¦¬ì†ŒìŠ¤ì— `data` ë¦¬ì†ŒìŠ¤ê°€ ì˜ì¡´í•˜ëŠ” ê²½ìš°**.

âœ… **ì˜ˆì œ (ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ê°’ìœ¼ë¡œ ì¸í•´ `apply`ê¹Œì§€ ì¡°íšŒ ë¯¸ë£¸)**

```hcl
resource "aws_instance" "web" {
  ami           = "ami-123456"
  instance_type = "t2.micro"
}

data "aws_instance" "web_info" {
  instance_id = aws_instance.web.id
}
```

- **`aws_instance.web.id`ëŠ” `plan` ë‹¨ê³„ì—ì„œëŠ” ì•Œ ìˆ˜ ì—†ìŒ**, ë”°ë¼ì„œ `apply`ê¹Œì§€ `data` ì¡°íšŒë¥¼ ë¯¸ë£¸.

---

### **Q3: Terraform `depends_on`ì„ `data` ê¶Œì¥í•˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ”?**

âœ… `depends_on`ì„ ì‚¬ìš©í•˜ë©´ **í•­ìƒ `apply`ê¹Œì§€ ì¡°íšŒë¥¼ ë¯¸ë£¨ê²Œ ë¨**.  
âœ… **ë¶ˆí•„ìš”í•œ ì˜ì¡´ì„±ì´ ìƒê¸°ë©´ì„œ Terraform ì‹¤í–‰ ì†ë„ ì €í•˜ ê°€ëŠ¥**.  
âœ… Terraform 0.12 ì´í•˜ì—ì„œëŠ” `depends_on`ì„ ì‚¬ìš©í•˜ë©´ `data` ë¦¬ì†ŒìŠ¤ê°€ ë¬´ì¡°ê±´ `apply` ë‹¨ê³„ê¹Œì§€ ë¯¸ë¤„ì§€ê¸° ë•Œë¬¸ì— **êµ¬ì„±ì´ ì˜ì›íˆ ìˆ˜ë ´í•˜ì§€ ì•Šì„ ê°€ëŠ¥ì„±ì´ ìˆìŒ**.

âœ… **ì˜ëª»ëœ ì˜ˆì œ (`depends_on` ì‚¬ìš©)**

```hcl
data "aws_vpc" "selected" {
  depends_on = [aws_vpc.main]
}
```

âœ… **ê¶Œì¥í•˜ëŠ” ë°©ì‹**

```hcl
data "aws_vpc" "selected" {
  id = aws_vpc.main.id
}
```

âœ… **ì´ë ‡ê²Œ í•˜ë©´ `plan`ì—ì„œ ì¡°íšŒí•  ìˆ˜ ìˆìœ¼ë©´ ì¡°íšŒí•˜ê³ , ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ `apply`ê¹Œì§€ ê¸°ë‹¤ë¦¼.**

---

### **Q4: Terraform `data` ë¦¬ì†ŒìŠ¤ì—ì„œ ì§€ì›í•˜ëŠ” `meta-arguments`ëŠ”?**

âœ… **ì¼ë°˜ ë¦¬ì†ŒìŠ¤(`resource`)ì™€ ë™ì¼í•œ `meta-arguments`ë¥¼ ì§€ì›**.  
âœ… ë‹¨, **`lifecycle` ë¸”ë¡ì€ ì§€ì›í•˜ì§€ ì•ŠìŒ**.

âœ… **ì˜ˆì œ (`count`, `for_each` ì‚¬ìš© ê°€ëŠ¥)**

```hcl
data "aws_ami" "latest" {
  count = 2
  most_recent = true
  owners      = ["self"]
}
```

---

# **í•µì‹¬ ìš”ì•½**

- **Terraform `data` ë¦¬ì†ŒìŠ¤ëŠ” ê¸°ì¡´ ì¸í”„ë¼ì—ì„œ ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©ë¨**.
- **ê¸°ë³¸ì ìœ¼ë¡œ `plan` ë‹¨ê³„ì—ì„œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì§€ë§Œ, ì˜ˆì¸¡í•  ìˆ˜ ì—†ëŠ” ê°’ì´ë‚˜ ë³€ê²½ë˜ëŠ” ë¦¬ì†ŒìŠ¤ì— ì˜ì¡´í•˜ë©´ `apply`ê¹Œì§€ ì¡°íšŒë¥¼ ë¯¸ë£¸**.
- **`depends_on`ì„ ì‚¬ìš©í•˜ë©´ í•­ìƒ `apply`ê¹Œì§€ ì¡°íšŒë¥¼ ë¯¸ë£¨ë¯€ë¡œ ê¶Œì¥ë˜ì§€ ì•ŠìŒ**.
- **ê´€ë¦¬í˜• ë¦¬ì†ŒìŠ¤(`resource`)ì™€ ë™ì¼í•œ `meta-arguments`ë¥¼ ì§€ì›í•˜ì§€ë§Œ, `lifecycle` ë¸”ë¡ì€ ì œì™¸ë¨**.

---

# **í•µì‹¬ í•„ê¸°**

## **1. Terraform `data` ë¦¬ì†ŒìŠ¤ë€?**

âœ… Terraformì´ **ê¸°ì¡´ ì¸í”„ë¼ ì •ë³´ë¥¼ ì¡°íšŒ**í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µ.  
âœ… **ìƒˆë¡œìš´ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ì§€ ì•Šê³ , ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ì˜ ì†ì„±ì„ ì½ì–´ì˜¤ê¸° ìœ„í•´ ì‚¬ìš©ë¨**.  
âœ… ì¼ë°˜ì ìœ¼ë¡œ **`plan` ë‹¨ê³„ì—ì„œ ë°ì´í„°ë¥¼ ì¡°íšŒ**í•˜ì§€ë§Œ, **íŠ¹ì • ê²½ìš°ì—ëŠ” `apply` ë‹¨ê³„ê¹Œì§€ ë¯¸ë£¸**.

âœ… **ê¸°ë³¸ ë¬¸ë²•**

```hcl
data "aws_ami" "latest" {
  most_recent = true
  owners      = ["self"]
}
```

âœ… **`.tfstate` íŒŒì¼ì— ì €ì¥ë˜ì§€ ì•Šê³  ë§¤ë²ˆ ì‹¤í–‰ ì‹œì ì— ë°ì´í„°ë¥¼ ì¡°íšŒ**.

---

## **2. Terraform `data` ë¦¬ì†ŒìŠ¤ì˜ ì¡°íšŒ íƒ€ì´ë°**

âœ… **`plan` ë‹¨ê³„ì—ì„œ ì¡°íšŒ (ê¸°ë³¸ ë™ì‘)**

```hcl
data "aws_availability_zones" "available" {}
```

âœ… **`apply`ê¹Œì§€ ì¡°íšŒë¥¼ ë¯¸ë£¨ëŠ” ê²½ìš°**

```hcl
resource "aws_instance" "web" {
  ami           = "ami-123456"
  instance_type = "t2.micro"
}

data "aws_instance" "web_info" {
  instance_id = aws_instance.web.id
}
```

âœ… **ì˜ˆì¸¡í•  ìˆ˜ ì—†ëŠ” ê°’(`aws_instance.web.id`)ì´ ì¡´ì¬í•˜ë¯€ë¡œ `apply` ë‹¨ê³„ê¹Œì§€ ëŒ€ê¸°**.

---

## **3. Terraform `data` ë¦¬ì†ŒìŠ¤ì™€ `depends_on` ë¬¸ì œì **

âœ… **`depends_on` ì‚¬ìš© ì‹œ ë¬´ì¡°ê±´ `apply`ê¹Œì§€ ëŒ€ê¸°í•˜ë¯€ë¡œ ë¹„íš¨ìœ¨ì **.  
âœ… **ê¶Œì¥ë˜ì§€ ì•ŠëŠ” ë°©ì‹ (`depends_on` ì‚¬ìš©)**

```hcl
data "aws_vpc" "selected" {
  depends_on = [aws_vpc.main]
}
```

âœ… **ê¶Œì¥í•˜ëŠ” ë°©ì‹ (`id`ë¥¼ ì§ì ‘ ì°¸ì¡°)**

```hcl
data "aws_vpc" "selected" {
  id = aws_vpc.main.id
}
```

âœ… **ì´ ë°©ì‹ì€ `plan`ì—ì„œ ì¡°íšŒ ê°€ëŠ¥í•˜ë©´ ì¡°íšŒí•˜ê³ , ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ `apply`ê¹Œì§€ ë¯¸ë£¸.**

---

## **4. Terraform `data` ë¦¬ì†ŒìŠ¤ì—ì„œ ì§€ì›í•˜ëŠ” `meta-arguments`**

âœ… **ì§€ì›ë˜ëŠ” `meta-arguments`**

- `count`
- `for_each`
- `provider`

âœ… **ì§€ì›ë˜ì§€ ì•ŠëŠ” `meta-arguments`**

- `lifecycle` (ì¼ë°˜ ë¦¬ì†ŒìŠ¤ì™€ ë‹¤ë¦„)

âœ… **ì˜ˆì œ (`count` ì‚¬ìš©)**

```hcl
data "aws_ami" "latest" {
  count = 2
  most_recent = true
  owners      = ["self"]
}
```

---

## **5. Terraform `data` ë¦¬ì†ŒìŠ¤ ì£¼ìš” ì˜ˆì œ**

âœ… **AWS VPC ì •ë³´ ì¡°íšŒ**

```hcl
data "aws_vpc" "selected" {
  id = "vpc-0abc12345def67890"
}
```

âœ… **AWS EC2 ì¸ìŠ¤í„´ìŠ¤ ì •ë³´ ì¡°íšŒ**

```hcl
data "aws_instance" "web" {
  instance_id = "i-0abcdef1234567890"
}
```

âœ… **AWS S3 ë²„í‚· ì •ë³´ ì¡°íšŒ**

```hcl
data "aws_s3_bucket" "my_bucket" {
  bucket = "my-bucket-name"
}
```

âœ… **AWS Security Group ì •ë³´ ì¡°íšŒ**

```hcl
data "aws_security_group" "web_sg" {
  name = "web-sg"
}
```

---

# **Terraform `data` ë¦¬ì†ŒìŠ¤ ì£¼ìš” ë¹„êµ**

|**ê¸°ëŠ¥**|**ì„¤ëª…**|**ì‚¬ìš© ì‚¬ë¡€**|
|---|---|---|
|**ê¸°ë³¸ ì¡°íšŒ (`plan`ì—ì„œ ì‹¤í–‰)**|ê¸°ë³¸ì ìœ¼ë¡œ `plan` ë‹¨ê³„ì—ì„œ ì‹¤í–‰|AWS AZ ëª©ë¡ ì¡°íšŒ|
|**`apply`ê¹Œì§€ ì¡°íšŒ ë¯¸ë£¸**|ê°’ì´ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•  ë•Œ `apply` ë‹¨ê³„ì—ì„œ ì‹¤í–‰|ì‹ ê·œ EC2 ID ì¡°íšŒ|
|**`depends_on` ì‚¬ìš© (ê¶Œì¥ X)**|í•­ìƒ `apply`ê¹Œì§€ ëŒ€ê¸°|`apply` ì§€ì—° ë¬¸ì œ ë°œìƒ|
|**ì§€ì›ë˜ëŠ” `meta-arguments`**|`count`, `for_each`, `provider` ì‚¬ìš© ê°€ëŠ¥|ë‹¤ì¤‘ ë¦¬ì†ŒìŠ¤ ì¡°íšŒ ê°€ëŠ¥|

---

# **Terraform `data` ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ì‹œ ì£¼ì˜ì **

âœ… **1. ê°€ëŠ¥í•˜ë©´ `plan`ì—ì„œ ì¡°íšŒí•˜ë„ë¡ ì½”ë“œ ì‘ì„±**.  
âœ… **2. `depends_on`ì„ ì‚¬ìš©í•˜ë©´ í•­ìƒ `apply`ê¹Œì§€ ëŒ€ê¸°í•˜ë¯€ë¡œ ì‚¬ìš©ì„ ì§€ì–‘í•´ì•¼ í•¨**.  
âœ… **3. `.tfstate`ì— ì €ì¥ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ í•­ìƒ ìµœì‹  ë°ì´í„°ë¥¼ ì¡°íšŒ**.  
âœ… **4. `lifecycle` ë¸”ë¡ì€ ì§€ì›ë˜ì§€ ì•ŠìŒ**.

---

# **ì°¸ê³  ìë£Œ**

- [Terraform ê³µì‹ ë¬¸ì„œ - Data Sources](https://developer.hashicorp.com/terraform/language/data-sources)
- [Terraform Data Source Dependencies](https://developer.hashicorp.com/terraform/language/data-sources#data-resource-dependencies)

---

## ğŸš€ **ê²°ë¡ **

- **Terraform `data` ë¦¬ì†ŒìŠ¤ëŠ” ê¸°ì¡´ ì¸í”„ë¼ ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ì—­í• ì„ í•˜ë©°, `plan`ì—ì„œ ì‹¤í–‰ë˜ì§€ë§Œ ê²½ìš°ì— ë”°ë¼ `apply`ê¹Œì§€ ëŒ€ê¸°í•  ìˆ˜ ìˆìŒ**.
- **`depends_on` ì‚¬ìš©ì€ ë¹„íš¨ìœ¨ì ì´ë¯€ë¡œ ì§ì ‘ ì°¸ì¡°í•˜ëŠ” ë°©ì‹ì´ ê¶Œì¥ë¨**.
- **Terraform `data` ë¦¬ì†ŒìŠ¤ë¥¼ í™œìš©í•˜ë©´ ìµœì‹  ìƒíƒœë¥¼ ìœ ì§€í•˜ë©´ì„œ ë™ì ìœ¼ë¡œ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŒ! ğŸš€**