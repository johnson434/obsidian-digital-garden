---
{"dg-publish":true,"permalink":"/06-full-notes/it-4-2/","dgPassFrontmatter":true}
---

[[03 - Tags/IT 엔지니어를 위한 네트워크\|IT 엔지니어를 위한 네트워크]]

# 단서 질문
- 스위치 장비 동작 방식
    스위치는 2계층 장비로 MAC 주소를 사용하여 통신하며 PDU는 프레임입니다. 스위치의 브로드캐스트를 통해서(ARP) 연결된 포트들로부터 패킷 응답을 받고 이 응답을 이용하여 MAC 주소와 포트 번호를 매핑합니다. 이를 어드레스 러닝이라고 합니다.
- 맥어드레스 러닝이란?
    스위치를 처음 켰을 때, ARP 테이블은 초기화 상태입니다. 따라서, ARP 프로토콜을 통한 플러딩을 통해서 MAC 주소와 매핑 되는 포트번호를 ARP 테이블에 저장합니다. 이 과정을 맥어드레스 러닝이라고 합니다.
- 플러딩이란?
    스위치의 모든 포트로 패킷이 전송되는 현상을 플러딩이라 합니다.
- VLAN이란?
    스위치를 여러 개의 스위치로 분할하는 방법입니다. 서브넷이 3계층에서 논리 주소인 IP를 분할하였다면 VLAN은 2계층에서 동작하면서 스위치의 포트를 여러 개의 스위치로 분할합니다. ==포트 기반 분할 방식==과 ==MAC 주소 분할 방식==이 있습니다.
- 패킷이란?
    네트워크 계층의 PDU이기도 하지만 데이터를 쪼개 전달하는 단위를 패킷이라고도 한다.
# 핵심 요약
- 스위치는 OSI 2계층에서 동작하는 장치이다.
- MAC 주소를 기반으로 통신을 하는 데에 중점을 둔다.
- 브로드캐스팅을 통한 ARP로 맥 주소와 포트 번호를 매핑하고 이를 통해 통신한다.
- 플러딩은 스위치에 연결된 모든 포트에 패킷을 보내는 것을 플러딩이라고 한다.
- VLAN은 스위치를 여러 개의 스위치로 사용하는 방법이다.
- VLAN은 MAC 주소 기반과 포트 번호 기반이 있다.

# 핵심 필기
## 4.1 스위치 장비 동작(P128)
과거 스위치가 존재하지 않을 시절에는 네트워크 통신을 위해 여러 노드들이 경합하는 상황이 발생했습니다. 이는 동시에 패킷을 전송하지 못하는 하드웨어의 문제였습니다. 그러나, **스위치의 등장**으로 인해 동시에 패킷을 전송 가능하게 됐습니다. 스위치는 MAC 주소와 포트의 번호가 매핑된 MAC 주소 테이블을 가지고 있으며 이로 인해 통신이 가능합니다.

ARP 프로토콜로 브로드캐스트를 통해서 노드의 NIC 카드로부터 MAC 주소를 확인하고 주소가 일치하면 스위치로 응답을 보냅니다. 이를 통해 MAC 주소 테이블을 업데이트하여 해당 MAC 주소가 이더넷에 몇번째 포트인지 기억합니다. 이로 인해 매 번 ARP를 사용할 필요는 없습니다.

MAC 주소와 매핑 되는 포트를 찾기 위한 동작 방식을 3가지가 있는데 밑에선 이 3가지를 알아보겠습니다.

### 4.1.1 플러딩(Flooding)
연결된 모든 포트에 패킷을 포워딩하는 방식을 플러딩이라고 합니다. 스위치는 전원을 키면 MAC 테이블의 정보가 아무 것도 없기 때문에 모든 패킷을 모든 포트에 포워딩합니다. 이 과정에서 MAC 주소를 학습한 후에 테이블에 기록하여 플러딩을 줄여갑니다.

### 4.1.2 어드레스 러닝(Address Learning)
어드레스 러닝은 패킷을 송신한 MAC 송신지의 주소를 사용하여 MAC 테이블의 포트와 매핑 되는 로우를 기록하는 방식입니다. 이전에 말한 브로드캐스팅을 이용한 ARP 프로토콜이 브로드캐스팅을 통해 MAC 주소를 송신하면 해당 MAC 주소를 소유한 노드에서 자신의 MAC 주소를 담은 패킷을 스위치에 전송합니다. 이를 스위치에서 MAC 테이블에 기록합니다. 이를 어드레스 러닝이라고 합니다.

### 4.1.3 포워딩/필터링
패킷에 명시된 MAC 주소와 매칭되는 포트로 데이터를 전송하는 것을 포워딩이라고 합니다. 이 때 다른 포트로 데이터를 전송하지 않는 것을 필터링이라고 합니다.

![Untitled 26.png](/img/user/image/Untitled%2026.png)

## 4.2 VLAN(P136)
### 4.2.1 VLAN이란?
LAN을 논리적으로 분할 구성하는 기술입니다. 스위치에 연결된 포트들을 그룹화해서 별개의 스위치처럼 사용이 가능합니다. 2계층에서 사용되는 기술로 3계층인 서브네팅과는 다릅니다. 서브네팅은 3계층인 IP의 분할을 위한 기술이지만 VLAN은 스위치의 포트의 분할을 위한 기술입니다.

VLAN을 통해 그룹화된 포트들은 서로 다른 네트워크이므로 로컬 통신이 아닌(MAC 주소로 통신이 불가) L3 계층 장비를 이용한 통신(IP)을 해야 합니다.

![Untitled 1 13.png](/img/user/image/Untitled%201%2013.png)

![Untitled 2 11.png](/img/user/image/Untitled%202%2011.png)

또한 다른 층에 있는 단말과도 네트워크로 묶을 수 있습니다.

![Untitled 3 10.png](/img/user/image/Untitled%203%2010.png)

### 4.2.2 VLAN의 종류와 특징
**포트 기반 VLAN**
스위치의 포트를 기반으로 네트워크를 논리적으로 분할하는 방법. 포트에 VLAN을 할당하고 해당 포트에 연결하는 단말들은 모두 해당 VLAN에 속한다.

**MAC 주소 기반 VLAN**
연결되는 단말에 따라서 해당 단말이 속하는 VLAN으로 사용되는 방법.
MAC 주소와 VLAN을 매핑하는 테이블이 있고 포트에 연결될때마다 해당 MAC 주소가 매핑 되는 VLAN을 할당한다. 따라서, 포트를 여기저기 옮겨도 고유 MAC 주소에 따른 VLAN으로 연결된다. 따라서, 자리이동이 편리하다.

### 4.2.3 VLAN 모드(Trunk/Access) 동작 방식

![Untitled 4 10.png](/img/user/image/Untitled%204%2010.png)
서로 다른 VLAN 간에 통신을 위해선 2가지 방식이 있습니다.
방법 1은 아래처럼 VLAN의 개수만큼 포트를 사용하여 해당 포트를 통해 VLAN끼리 연결합니다.

![Untitled 5 7.png](/img/user/image/Untitled%205%207.png)
그러나 위 방법은 포트의 낭비가 발생합니다. 이를 보완하는 것이 VLAN 태그 기능입니다.
태그 포트 또는 트렁크(Trunk) 포트라고도 불리는 한 개의 포트를 사용하여 여러 VLAN과 통신합니다. 태그 포트로 패킷을 보낼 때는 VLAN의 아이디를 같이 송신하여 해당 VLAN으로 보낼 수 있도록 합니다.

![Untitled 6 6.png](/img/user/image/Untitled%206%206.png)

![Untitled 7 6.png](/img/user/image/Untitled%207%206.png)

![Untitled 8 5.png](/img/user/image/Untitled%208%205.png)

